
#.##.....##....###....########..####....###....########..##.......########..######.
#.##.....##...##.##...##.....##..##....##.##...##.....##.##.......##.......##....##
#.##.....##..##...##..##.....##..##...##...##..##.....##.##.......##.......##......
#.##.....##.##.....##.########...##..##.....##.########..##.......######....######.
#..##...##..#########.##...##....##..#########.##.....##.##.......##.............##
#...##.##...##.....##.##....##...##..##.....##.##.....##.##.......##.......##....##
#....###....##.....##.##.....##.####.##.....##.########..########.########..######.
#
CC = g++
CFLAGS = -W -Wall -g -std=c++1y -fPIC -m64 -DUNIX -O3
SERVER_EXEC = ./bin/server
CLIENT_EXEC = ./bin/client

INCLUDES =

COMMON_LIBS =

COMMON_HEADERS = \
	./includes/pcslib.h \
	./includes/signal.h
COMMON_SOURCES = \
	./includes/pcslib.cpp
COMMON_OBJECTS = $(COMMON_SOURCES:.cpp=.o)

#.########....###....########...######...########.########..######.
#....##......##.##...##.....##.##....##..##..........##....##....##
#....##.....##...##..##.....##.##........##..........##....##......
#....##....##.....##.########..##...####.######......##.....######.
#....##....#########.##...##...##....##..##..........##..........##
#....##....##.....##.##....##..##....##..##..........##....##....##
#....##....##.....##.##.....##..######...########....##.....######.
#

#..####...######..#####...##..##..######..#####..
#.##......##......##..##..##..##..##......##..##.
#..####...####....#####...##..##..####....#####..
#.....##..##......##..##...####...##......##..##.
#..####...######..##..##....##....######..##..##.
#................................................
#

SERVER_HEADERS =

SERVER_SOURCES = \
		./src/server/main.cpp
SERVER_OBJECTS = $(SERVER_SOURCES:.cpp=.o)

server : $(SERVER_HEADERS) $(COMMON_HEADERS) $(SERVER_OBJECTS) $(COMMON_OBJECTS)
	$(CC) -pthread -o $(SERVER_EXEC) $(SERVER_OBJECTS) $(COMMON_OBJECTS) $(COMMON_LIBS)

#..####...##......######..######..##..##..######.
#.##..##..##........##....##......###.##....##...
#.##......##........##....####....##.###....##...
#.##..##..##........##....##......##..##....##...
#..####...######..######..######..##..##....##...
#................................................
#

CLIENT_HEADERS =

CLIENT_SOURCES = \
		./src/client/main.cpp
CLIENT_OBJECTS = $(CLIENT_SOURCES:.cpp=.o)

client : $(CLIENT_HEADERS) $(COMMON_HEADERS) $(CLIENT_OBJECTS) $(COMMON_OBJECTS)
	$(CC) -pthread -o $(CLIENT_EXEC) $(CLIENT_OBJECTS) $(COMMON_OBJECTS) $(COMMON_LIBS)

#..####...##......##.....
#.##..##..##......##.....
#.######..##......##.....
#.##..##..##......##.....
#.##..##..######..######.
#........................
#

all : server client

#..####...##......######...####...##..##.
#.##..##..##......##......##..##..###.##.
#.##......##......####....######..##.###.
#.##..##..##......##......##..##..##..##.
#..####...######..######..##..##..##..##.
#........................................
#

clean :
	rm $(SERVER_EXEC) $(SERVER_OBJECTS) $(CLIENT_EXEC) $(CLIENT_OBJECTS) $(COMMON_OBJECTS)

%.o: %.cpp
	$(CC) $(CFLAGS) $(INCLUDES) -o $@ -c $<

%.o: %.cc
	$(CC) $(CFLAGS) $(INCLUDES) -o $@ -c $<

%.o: %.c
	gcc $(CFLAGS) $(INCLUDES) -o $@ -c $<
